{"version":3,"file":"startup-logger.js","sources":["../../src/utils/startup-logger.ts"],"sourcesContent":["import chalk from 'chalk';\nimport CLITable from 'cli-table3';\nimport _ from 'lodash/fp';\n\nimport type { Core } from '@strapi/types';\n\nexport const createStartupLogger = (app: Core.Strapi) => {\n  return {\n    logStats() {\n      const columns = Math.min(process.stderr.columns, 80) - 2;\n      console.log();\n      console.log(chalk.black.bgWhite(_.padEnd(columns, ' Project information')));\n      console.log();\n\n      const infoTable = new CLITable({\n        colWidths: [20, 50],\n        chars: { mid: '', 'left-mid': '', 'mid-mid': '', 'right-mid': '' },\n      });\n\n      const dbInfo = app.db?.getInfo();\n\n      infoTable.push(\n        [chalk.blue('Time'), `${new Date()}`],\n        [chalk.blue('Launched in'), `${Date.now() - app.config.launchedAt} ms`],\n        [chalk.blue('Environment'), app.config.environment],\n        [chalk.blue('Process PID'), process.pid],\n        [chalk.blue('Version'), `${app.config.info.strapi} (node ${process.version})`],\n        [chalk.blue('Edition'), app.EE ? 'Enterprise' : 'Community'],\n        [chalk.blue('Database'), dbInfo?.client],\n        [chalk.blue('Database name'), dbInfo?.displayName]\n      );\n\n      if (dbInfo?.schema) {\n        infoTable.push([chalk.blue('Database schema'), dbInfo.schema]);\n      }\n\n      console.log(infoTable.toString());\n      console.log();\n      console.log(chalk.black.bgWhite(_.padEnd(columns, ' Actions available')));\n      console.log();\n    },\n\n    logFirstStartupMessage() {\n      if (!strapi.config.get('server.logger.startup.enabled')) {\n        return;\n      }\n\n      this.logStats();\n\n      console.log(chalk.bold('One more thing...'));\n      console.log(\n        chalk.grey('Create your first administrator üíª by going to the administration panel at:')\n      );\n      console.log();\n\n      const addressTable = new CLITable();\n\n      const adminUrl = strapi.config.get('admin.absoluteUrl');\n      addressTable.push([chalk.bold(adminUrl)]);\n\n      console.log(`${addressTable.toString()}`);\n      console.log();\n    },\n\n    logDefaultStartupMessage() {\n      if (!strapi.config.get('server.logger.startup.enabled')) {\n        return;\n      }\n      this.logStats();\n\n      console.log(chalk.bold('Welcome back!'));\n\n      if (app.config.get('admin.serveAdminPanel') === true) {\n        console.log(chalk.grey('To manage your project üöÄ, go to the administration panel at:'));\n        const adminUrl = strapi.config.get('admin.absoluteUrl');\n        console.log(chalk.bold(adminUrl));\n        console.log();\n      }\n\n      console.log(chalk.grey('To access the server ‚ö°Ô∏è, go to:'));\n      const serverUrl = strapi.config.get('server.absoluteUrl');\n      console.log(chalk.bold(serverUrl));\n      console.log();\n    },\n\n    logStartupMessage({ isInitialized }: { isInitialized: boolean }) {\n      if (!strapi.config.get('server.logger.startup.enabled')) {\n        return;\n      }\n      if (!isInitialized) {\n        this.logFirstStartupMessage();\n      } else {\n        this.logDefaultStartupMessage();\n      }\n    },\n  };\n};\n"],"names":["chalk","_","CLITable"],"mappings":";;;;;;;;;AAMa,MAAA,sBAAsB,CAAC,QAAqB;AAChD,SAAA;AAAA,IACL,WAAW;AACT,YAAM,UAAU,KAAK,IAAI,QAAQ,OAAO,SAAS,EAAE,IAAI;AACvD,cAAQ,IAAI;AACJ,cAAA,IAAIA,uBAAM,MAAM,QAAQC,oBAAE,OAAO,SAAS,sBAAsB,CAAC,CAAC;AAC1E,cAAQ,IAAI;AAEN,YAAA,YAAY,IAAIC,0BAAS;AAAA,QAC7B,WAAW,CAAC,IAAI,EAAE;AAAA,QAClB,OAAO,EAAE,KAAK,IAAI,YAAY,IAAI,WAAW,IAAI,aAAa,GAAG;AAAA,MAAA,CAClE;AAEK,YAAA,SAAS,IAAI,IAAI,QAAQ;AAErB,gBAAA;AAAA,QACR,CAACF,eAAAA,QAAM,KAAK,MAAM,GAAG,GAAG,oBAAI,KAAM,CAAA,EAAE;AAAA,QACpC,CAACA,uBAAM,KAAK,aAAa,GAAG,GAAG,KAAK,IAAA,IAAQ,IAAI,OAAO,UAAU,KAAK;AAAA,QACtE,CAACA,eAAAA,QAAM,KAAK,aAAa,GAAG,IAAI,OAAO,WAAW;AAAA,QAClD,CAACA,eAAM,QAAA,KAAK,aAAa,GAAG,QAAQ,GAAG;AAAA,QACvC,CAACA,eAAA,QAAM,KAAK,SAAS,GAAG,GAAG,IAAI,OAAO,KAAK,MAAM,UAAU,QAAQ,OAAO,GAAG;AAAA,QAC7E,CAACA,eAAAA,QAAM,KAAK,SAAS,GAAG,IAAI,KAAK,eAAe,WAAW;AAAA,QAC3D,CAACA,eAAM,QAAA,KAAK,UAAU,GAAG,QAAQ,MAAM;AAAA,QACvC,CAACA,eAAM,QAAA,KAAK,eAAe,GAAG,QAAQ,WAAW;AAAA,MACnD;AAEA,UAAI,QAAQ,QAAQ;AACR,kBAAA,KAAK,CAACA,uBAAM,KAAK,iBAAiB,GAAG,OAAO,MAAM,CAAC;AAAA,MAAA;AAGvD,cAAA,IAAI,UAAU,UAAU;AAChC,cAAQ,IAAI;AACJ,cAAA,IAAIA,uBAAM,MAAM,QAAQC,oBAAE,OAAO,SAAS,oBAAoB,CAAC,CAAC;AACxE,cAAQ,IAAI;AAAA,IACd;AAAA,IAEA,yBAAyB;AACvB,UAAI,CAAC,OAAO,OAAO,IAAI,+BAA+B,GAAG;AACvD;AAAA,MAAA;AAGF,WAAK,SAAS;AAEd,cAAQ,IAAID,eAAAA,QAAM,KAAK,mBAAmB,CAAC;AACnC,cAAA;AAAA,QACNA,eAAA,QAAM,KAAK,6EAA6E;AAAA,MAC1F;AACA,cAAQ,IAAI;AAEN,YAAA,eAAe,IAAIE,0BAAS;AAElC,YAAM,WAAW,OAAO,OAAO,IAAI,mBAAmB;AACtD,mBAAa,KAAK,CAACF,eAAAA,QAAM,KAAK,QAAQ,CAAC,CAAC;AAExC,cAAQ,IAAI,GAAG,aAAa,SAAA,CAAU,EAAE;AACxC,cAAQ,IAAI;AAAA,IACd;AAAA,IAEA,2BAA2B;AACzB,UAAI,CAAC,OAAO,OAAO,IAAI,+BAA+B,GAAG;AACvD;AAAA,MAAA;AAEF,WAAK,SAAS;AAEd,cAAQ,IAAIA,eAAAA,QAAM,KAAK,eAAe,CAAC;AAEvC,UAAI,IAAI,OAAO,IAAI,uBAAuB,MAAM,MAAM;AACpD,gBAAQ,IAAIA,eAAAA,QAAM,KAAK,+DAA+D,CAAC;AACvF,cAAM,WAAW,OAAO,OAAO,IAAI,mBAAmB;AACtD,gBAAQ,IAAIA,eAAAA,QAAM,KAAK,QAAQ,CAAC;AAChC,gBAAQ,IAAI;AAAA,MAAA;AAGd,cAAQ,IAAIA,eAAAA,QAAM,KAAK,iCAAiC,CAAC;AACzD,YAAM,YAAY,OAAO,OAAO,IAAI,oBAAoB;AACxD,cAAQ,IAAIA,eAAAA,QAAM,KAAK,SAAS,CAAC;AACjC,cAAQ,IAAI;AAAA,IACd;AAAA,IAEA,kBAAkB,EAAE,iBAA6C;AAC/D,UAAI,CAAC,OAAO,OAAO,IAAI,+BAA+B,GAAG;AACvD;AAAA,MAAA;AAEF,UAAI,CAAC,eAAe;AAClB,aAAK,uBAAuB;AAAA,MAAA,OACvB;AACL,aAAK,yBAAyB;AAAA,MAAA;AAAA,IAChC;AAAA,EAEJ;AACF;;"}