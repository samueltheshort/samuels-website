{"version":3,"file":"webhooks.js","sources":["../../src/providers/webhooks.ts"],"sourcesContent":["import { defineProvider } from './provider';\nimport { createWebhookStore, webhookModel } from '../services/webhook-store';\nimport createWebhookRunner from '../services/webhook-runner';\n\nexport default defineProvider({\n  init(strapi) {\n    strapi.get('models').add(webhookModel);\n\n    strapi.add('webhookStore', () => createWebhookStore({ db: strapi.db }));\n    strapi.add('webhookRunner', () =>\n      createWebhookRunner({\n        eventHub: strapi.eventHub,\n        logger: strapi.log,\n        configuration: strapi.config.get('server.webhooks', {}),\n        fetch: strapi.fetch,\n      })\n    );\n  },\n  async bootstrap(strapi) {\n    const webhooks = await strapi.get('webhookStore').findWebhooks();\n    if (!webhooks) {\n      return;\n    }\n\n    for (const webhook of webhooks) {\n      strapi.get('webhookRunner').add(webhook);\n    }\n  },\n});\n"],"names":["defineProvider","webhookModel","createWebhookStore","createWebhookRunner","webhooks"],"mappings":";;;;AAIA,MAAA,WAAeA,wBAAe;AAAA,EAC5B,KAAK,QAAQ;AACX,WAAO,IAAI,QAAQ,EAAE,IAAIC,aAAAA,YAAY;AAE9B,WAAA,IAAI,gBAAgB,MAAMC,aAAAA,mBAAmB,EAAE,IAAI,OAAO,GAAG,CAAC,CAAC;AAC/D,WAAA;AAAA,MAAI;AAAA,MAAiB,MAC1BC,cAAoB;AAAA,QAClB,UAAU,OAAO;AAAA,QACjB,QAAQ,OAAO;AAAA,QACf,eAAe,OAAO,OAAO,IAAI,mBAAmB,CAAA,CAAE;AAAA,QACtD,OAAO,OAAO;AAAA,MACf,CAAA;AAAA,IACH;AAAA,EACF;AAAA,EACA,MAAM,UAAU,QAAQ;AACtB,UAAMC,YAAW,MAAM,OAAO,IAAI,cAAc,EAAE,aAAa;AAC/D,QAAI,CAACA,WAAU;AACb;AAAA,IAAA;AAGF,eAAW,WAAWA,WAAU;AAC9B,aAAO,IAAI,eAAe,EAAE,IAAI,OAAO;AAAA,IAAA;AAAA,EACzC;AAEJ,CAAC;;"}