{"version":3,"file":"api.mjs","sources":["../../../src/services/server/api.ts"],"sourcesContent":["import Router from '@koa/router';\nimport type { Core } from '@strapi/types';\n\nimport { createRouteManager } from './routing';\n\ninterface Options {\n  prefix?: string;\n  type?: string;\n}\n\nconst createAPI = (strapi: Core.Strapi, opts: Options = {}) => {\n  const { prefix, type } = opts;\n\n  const api = new Router({ prefix });\n\n  const routeManager = createRouteManager(strapi, { type });\n\n  return {\n    listRoutes() {\n      return [...api.stack];\n    },\n\n    use(fn: Router.Middleware) {\n      api.use(fn);\n      return this;\n    },\n\n    routes(routes: Core.Router | Core.Route[]) {\n      routeManager.addRoutes(routes, api);\n      return this;\n    },\n\n    mount(router: Router) {\n      router.use(api.routes(), api.allowedMethods());\n      return this;\n    },\n  };\n};\n\nexport { createAPI };\n"],"names":[],"mappings":";;AAUA,MAAM,YAAY,CAAC,QAAqB,OAAgB,OAAO;AACvD,QAAA,EAAE,QAAQ,KAAA,IAAS;AAEzB,QAAM,MAAM,IAAI,OAAO,EAAE,QAAQ;AAEjC,QAAM,eAAe,mBAAmB,QAAQ,EAAE,MAAM;AAEjD,SAAA;AAAA,IACL,aAAa;AACJ,aAAA,CAAC,GAAG,IAAI,KAAK;AAAA,IACtB;AAAA,IAEA,IAAI,IAAuB;AACzB,UAAI,IAAI,EAAE;AACH,aAAA;AAAA,IACT;AAAA,IAEA,OAAO,QAAoC;AAC5B,mBAAA,UAAU,QAAQ,GAAG;AAC3B,aAAA;AAAA,IACT;AAAA,IAEA,MAAM,QAAgB;AACpB,aAAO,IAAI,IAAI,OAAA,GAAU,IAAI,gBAAgB;AACtC,aAAA;AAAA,IAAA;AAAA,EAEX;AACF;"}