{"version":3,"file":"errors.mjs","sources":["../../src/middlewares/errors.ts"],"sourcesContent":["import { errors } from '@strapi/utils';\nimport type { Core } from '@strapi/types';\n\nimport { formatApplicationError, formatHttpError, formatInternalError } from '../services/errors';\n\nconst errorMiddleware: Core.MiddlewareFactory = (/* _, { strapi } */) => {\n  return async (ctx, next) => {\n    try {\n      await next();\n\n      if (!ctx.response._explicitStatus) {\n        return ctx.notFound();\n      }\n    } catch (error) {\n      if (error instanceof errors.ApplicationError) {\n        const { status, body } = formatApplicationError(error);\n        ctx.status = status;\n        ctx.body = body;\n        return;\n      }\n\n      if (error instanceof errors.HttpError) {\n        const { status, body } = formatHttpError(error);\n        ctx.status = status;\n        ctx.body = body;\n        return;\n      }\n\n      strapi.log.error(error);\n\n      const { status, body } = formatInternalError(error);\n      ctx.status = status;\n      ctx.body = body;\n    }\n  };\n};\n\nexport { errorMiddleware as errors };\n"],"names":["status","body"],"mappings":";;AAKA,MAAM,kBAA0C,MAAyB;AAChE,SAAA,OAAO,KAAK,SAAS;AACtB,QAAA;AACF,YAAM,KAAK;AAEP,UAAA,CAAC,IAAI,SAAS,iBAAiB;AACjC,eAAO,IAAI,SAAS;AAAA,MAAA;AAAA,aAEf,OAAO;AACV,UAAA,iBAAiB,OAAO,kBAAkB;AAC5C,cAAM,EAAE,QAAAA,SAAQ,MAAAC,MAAK,IAAI,uBAAuB,KAAK;AACrD,YAAI,SAASD;AACb,YAAI,OAAOC;AACX;AAAA,MAAA;AAGE,UAAA,iBAAiB,OAAO,WAAW;AACrC,cAAM,EAAE,QAAAD,SAAQ,MAAAC,MAAK,IAAI,gBAAgB,KAAK;AAC9C,YAAI,SAASD;AACb,YAAI,OAAOC;AACX;AAAA,MAAA;AAGK,aAAA,IAAI,MAAM,KAAK;AAEtB,YAAM,EAAE,QAAQ,SAAS,oBAAoB,KAAK;AAClD,UAAI,SAAS;AACb,UAAI,OAAO;AAAA,IAAA;AAAA,EAEf;AACF;"}