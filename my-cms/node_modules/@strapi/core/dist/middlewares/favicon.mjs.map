{"version":3,"file":"favicon.mjs","sources":["../../src/middlewares/favicon.ts"],"sourcesContent":["import { existsSync } from 'fs';\nimport { resolve } from 'path';\nimport koaFavicon from 'koa-favicon';\nimport type { Core } from '@strapi/types';\n\nexport type Config = NonNullable<Parameters<typeof koaFavicon>[1]>;\n\nconst defaults = {\n  path: 'favicon.png',\n  maxAge: 86400000,\n};\n\nexport const favicon: Core.MiddlewareFactory<Config> = (config, { strapi }) => {\n  const { maxAge, path: faviconDefaultPath } = { ...defaults, ...config };\n  const { root: appRoot } = strapi.dirs.app;\n  let faviconPath = faviconDefaultPath;\n\n  /** TODO (v5): Updating the favicon to use a png caused\n   *  https://github.com/strapi/strapi/issues/14693\n   *\n   *  This check ensures backwards compatibility until\n   *  the next major version\n   */\n  if (!existsSync(resolve(appRoot, faviconPath))) {\n    faviconPath = 'favicon.ico';\n  }\n\n  return koaFavicon(resolve(appRoot, faviconPath), { maxAge });\n};\n"],"names":[],"mappings":";;;AAOA,MAAM,WAAW;AAAA,EACf,MAAM;AAAA,EACN,QAAQ;AACV;AAEO,MAAM,UAA0C,CAAC,QAAQ,EAAE,aAAa;AACvE,QAAA,EAAE,QAAQ,MAAM,uBAAuB,EAAE,GAAG,UAAU,GAAG,OAAO;AACtE,QAAM,EAAE,MAAM,QAAQ,IAAI,OAAO,KAAK;AACtC,MAAI,cAAc;AAQlB,MAAI,CAAC,WAAW,QAAQ,SAAS,WAAW,CAAC,GAAG;AAChC,kBAAA;AAAA,EAAA;AAGhB,SAAO,WAAW,QAAQ,SAAS,WAAW,GAAG,EAAE,QAAQ;AAC7D;"}