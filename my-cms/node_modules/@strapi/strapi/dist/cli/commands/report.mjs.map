{"version":3,"file":"report.mjs","sources":["../../../src/cli/commands/report.ts"],"sourcesContent":["import { createCommand } from 'commander';\nimport { EOL } from 'os';\nimport { createStrapi, compileStrapi } from '@strapi/core';\nimport type { StrapiCommand } from '../types';\nimport { runAction } from '../utils/helpers';\n\ninterface CmdOptions {\n  uuid: boolean;\n  dependencies: boolean;\n  all: boolean;\n}\n\nconst action = async ({ uuid, dependencies, all }: CmdOptions) => {\n  const config = {\n    reportUUID: Boolean(all || uuid),\n    reportDependencies: Boolean(all || dependencies),\n  };\n\n  const appContext = await compileStrapi();\n  const app = await createStrapi(appContext).register();\n\n  let debugInfo = `Launched In: ${Date.now() - app.config.launchedAt} ms\nEnvironment: ${app.config.environment}\nOS: ${process.platform}-${process.arch}\nStrapi Version: ${app.config.info.strapi}\nNode/Yarn Version: ${process.env.npm_config_user_agent}\nEdition: ${app.EE ? 'Enterprise' : 'Community'}\nDatabase: ${app?.config?.database?.connection?.client ?? 'unknown'}`;\n\n  if (config.reportUUID) {\n    debugInfo += `${EOL}UUID: ${app.config.uuid}`;\n  }\n\n  if (config.reportDependencies) {\n    debugInfo += `${EOL}Dependencies: ${JSON.stringify(app.config.info.dependencies, null, 2)}\nDev Dependencies: ${JSON.stringify(app.config.info.devDependencies, null, 2)}`;\n  }\n\n  console.log(debugInfo);\n\n  await app.destroy();\n};\n\n/**\n * `$ strapi report`\n */\nconst command: StrapiCommand = () => {\n  return createCommand('report')\n    .description('Get system stats for debugging and submitting issues')\n    .option('-u, --uuid', 'Include Project UUID')\n    .option('-d, --dependencies', 'Include Project Dependencies')\n    .option('--all', 'Include All Information')\n    .action(runAction('report', action));\n};\n\nexport { command };\n"],"names":[],"mappings":";;;;AAYA,MAAM,SAAS,OAAO,EAAE,MAAM,cAAc,UAAsB;AAChE,QAAM,SAAS;AAAA,IACb,YAAY,QAAQ,OAAO,IAAI;AAAA,IAC/B,oBAAoB,QAAQ,OAAO,YAAY;AAAA,EACjD;AAEM,QAAA,aAAa,MAAM,cAAc;AACvC,QAAM,MAAM,MAAM,aAAa,UAAU,EAAE,SAAS;AAEpD,MAAI,YAAY,gBAAgB,KAAK,QAAQ,IAAI,OAAO,UAAU;AAAA,eACrD,IAAI,OAAO,WAAW;AAAA,MAC/B,QAAQ,QAAQ,IAAI,QAAQ,IAAI;AAAA,kBACpB,IAAI,OAAO,KAAK,MAAM;AAAA,qBACnB,QAAQ,IAAI,qBAAqB;AAAA,WAC3C,IAAI,KAAK,eAAe,WAAW;AAAA,YAClC,KAAK,QAAQ,UAAU,YAAY,UAAU,SAAS;AAEhE,MAAI,OAAO,YAAY;AACrB,iBAAa,GAAG,GAAG,SAAS,IAAI,OAAO,IAAI;AAAA,EAAA;AAG7C,MAAI,OAAO,oBAAoB;AAChB,iBAAA,GAAG,GAAG,iBAAiB,KAAK,UAAU,IAAI,OAAO,KAAK,cAAc,MAAM,CAAC,CAAC;AAAA,oBACzE,KAAK,UAAU,IAAI,OAAO,KAAK,iBAAiB,MAAM,CAAC,CAAC;AAAA,EAAA;AAG1E,UAAQ,IAAI,SAAS;AAErB,QAAM,IAAI,QAAQ;AACpB;AAKA,MAAM,UAAyB,MAAM;AAC5B,SAAA,cAAc,QAAQ,EAC1B,YAAY,sDAAsD,EAClE,OAAO,cAAc,sBAAsB,EAC3C,OAAO,sBAAsB,8BAA8B,EAC3D,OAAO,SAAS,yBAAyB,EACzC,OAAO,UAAU,UAAU,MAAM,CAAC;AACvC;"}