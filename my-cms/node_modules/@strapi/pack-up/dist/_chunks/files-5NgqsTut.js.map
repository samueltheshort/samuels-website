{"version":3,"file":"files-5NgqsTut.js","sources":["../../src/node/core/files.ts"],"sourcesContent":["import { readdir, lstat, access, mkdir } from 'fs/promises';\n\n/**\n * @internal\n */\nconst isEmptyDirectory = async (dir: string) => {\n  const files = await readdir(dir);\n\n  return files.length === 0;\n};\n\n/**\n * @internal\n */\nconst isDirectory = async (dir: string) => {\n  const stats = await lstat(dir);\n\n  return stats.isDirectory();\n};\n\n/**\n * @internal\n */\nconst pathExists = async (path: string) => {\n  try {\n    await access(path);\n    return true;\n  } catch (error) {\n    return false;\n  }\n};\n\n/**\n * @internal\n *\n * @description Ensures that the path is viable for a package to be created at\n * by checking if it exists, if not creating it and if it does exist ensuring it's\n * an empty directory. It will fail if any of these conditions are not met.\n */\nconst ensurePackagePathIsViable = async (path: string) => {\n  const exists = await pathExists(path);\n\n  if (!exists) {\n    await mkdir(path, { recursive: true });\n  }\n\n  const isEmpty = await isEmptyDirectory(path);\n\n  if (!isEmpty) {\n    throw new Error(`${path} is not empty`);\n  }\n\n  const isDir = await isDirectory(path);\n\n  if (!isDir) {\n    throw new Error(`${path} is not a directory`);\n  }\n};\n\nexport { ensurePackagePathIsViable, pathExists };\n"],"names":["readdir","lstat","access","mkdir"],"mappings":";;AAKA,MAAM,mBAAmB,OAAO,QAAgB;AACxC,QAAA,QAAQ,MAAMA,WAAQ,GAAG;AAE/B,SAAO,MAAM,WAAW;AAC1B;AAKA,MAAM,cAAc,OAAO,QAAgB;AACnC,QAAA,QAAQ,MAAMC,SAAM,GAAG;AAE7B,SAAO,MAAM;AACf;AAKM,MAAA,aAAa,OAAO,SAAiB;AACrC,MAAA;AACF,UAAMC,GAAAA,OAAO,IAAI;AACV,WAAA;AAAA,WACA,OAAO;AACP,WAAA;AAAA,EACT;AACF;AASM,MAAA,4BAA4B,OAAO,SAAiB;AAClD,QAAA,SAAS,MAAM,WAAW,IAAI;AAEpC,MAAI,CAAC,QAAQ;AACX,UAAMC,GAAM,MAAA,MAAM,EAAE,WAAW,KAAM,CAAA;AAAA,EACvC;AAEM,QAAA,UAAU,MAAM,iBAAiB,IAAI;AAE3C,MAAI,CAAC,SAAS;AACZ,UAAM,IAAI,MAAM,GAAG,IAAI,eAAe;AAAA,EACxC;AAEM,QAAA,QAAQ,MAAM,YAAY,IAAI;AAEpC,MAAI,CAAC,OAAO;AACV,UAAM,IAAI,MAAM,GAAG,IAAI,qBAAqB;AAAA,EAC9C;AACF;;;"}